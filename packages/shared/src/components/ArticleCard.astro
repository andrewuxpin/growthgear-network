---
import { formatDate } from "../utils";

interface Props {
  title: string;
  description: string;
  href: string;
  image?: {
    src: string;
    alt: string;
  };
  date: Date | string;
  category?: string;
  categoryHref?: string;
  readingTime?: number;
  featured?: boolean;
}

const { title, description, href, image, date, category, categoryHref, readingTime, featured = false } = Astro.props;

// Placeholder gradient colors for articles without images
const placeholderColors = [
  "from-blue-500 to-purple-600",
  "from-green-500 to-teal-600",
  "from-orange-500 to-red-600",
  "from-pink-500 to-rose-600",
  "from-indigo-500 to-blue-600",
];
const colorIndex = title.length % placeholderColors.length;
const placeholderGradient = placeholderColors[colorIndex];
---

<article class={`group ${featured ? "md:col-span-2" : ""}`}>
  <a href={href} class="block cursor-pointer">
    <div class={`relative overflow-hidden rounded-xl bg-gray-100 ${featured ? "aspect-[2/1]" : "aspect-[16/9]"}`}>
      {image ? (
        <img
          src={image.src}
          alt={image.alt}
          class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
          decoding="async"
        />
      ) : (
        <div class={`w-full h-full bg-gradient-to-br ${placeholderGradient} flex items-center justify-center transition-transform duration-300 group-hover:scale-105`}>
          <span class="text-white text-4xl font-bold opacity-30">{title.charAt(0).toUpperCase()}</span>
        </div>
      )}
    </div>

    <div class="mt-4">
      {category && (
        <div class="mb-2">
          {categoryHref ? (
            <a
              href={categoryHref}
              class="text-xs font-semibold uppercase tracking-wide text-primary-600 hover:text-primary-800"
              onclick="event.stopPropagation()"
            >
              {category}
            </a>
          ) : (
            <span class="text-xs font-semibold uppercase tracking-wide text-primary-600">
              {category}
            </span>
          )}
        </div>
      )}

      <h3 class={`font-bold text-gray-900 group-hover:text-primary-600 transition-colors ${featured ? "text-2xl md:text-3xl" : "text-lg"}`}>
        {title}
      </h3>

      <p class={`mt-2 text-gray-600 line-clamp-2 ${featured ? "text-base" : "text-sm"}`}>
        {description}
      </p>

      <div class="mt-3 flex items-center gap-3 text-sm text-gray-500">
        <time datetime={new Date(date).toISOString()}>
          {formatDate(date)}
        </time>
        {readingTime && (
          <>
            <span class="text-gray-300">&bull;</span>
            <span>{readingTime} min read</span>
          </>
        )}
      </div>
    </div>
  </a>
</article>
